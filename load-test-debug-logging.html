<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Load Test Debug Logging - The Swanling Book</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="HTTP Load testing framework. Inspired by Locust and Drill. Implemented with Rust.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="favicon.svg">
                        <link rel="shortcut icon" href="favicon.png">
                <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
                <link rel="stylesheet" href="css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
                <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="overview.html">Overview</a></li><li class="chapter-item expanded affix "><li class="part-title">Swanling</li><li class="chapter-item expanded "><a href="getting-started.html"><strong aria-hidden="true">1.</strong> Getting Started</a></li><li class="chapter-item expanded "><a href="simple-example.html"><strong aria-hidden="true">2.</strong> Simple Example</a></li><li class="chapter-item expanded "><a href="scheduling-swanling-task-sets.html"><strong aria-hidden="true">3.</strong> Scheduling Swanling Task Sets</a></li><li class="chapter-item expanded "><a href="defaults.html"><strong aria-hidden="true">4.</strong> Defaults</a></li><li class="chapter-item expanded "><a href="controlling-running-swanling-load-test.html"><strong aria-hidden="true">5.</strong> Controlling Running Swanling Load Test</a></li><li class="chapter-item expanded "><a href="throttling-requests.html"><strong aria-hidden="true">6.</strong> Throttling Requests</a></li><li class="chapter-item expanded "><a href="logging-load-test-errors.html"><strong aria-hidden="true">7.</strong> Logging Load Test Errors</a></li><li class="chapter-item expanded "><a href="logging-load-test-requests.html"><strong aria-hidden="true">8.</strong> Logging Load Test Requests</a></li><li class="chapter-item expanded "><a href="logging-load-test-tasks.html"><strong aria-hidden="true">9.</strong> Logging Load Test Tasks</a></li><li class="chapter-item expanded "><a href="load-test-debug-logging.html" class="active"><strong aria-hidden="true">10.</strong> Load Test Debug Logging</a></li><li class="chapter-item expanded "><a href="coordinated-omission-mitigation.html"><strong aria-hidden="true">11.</strong> Coordinated Omission Mitigation</a></li><li class="chapter-item expanded affix "><li class="part-title">Regatta</li><li class="chapter-item expanded "><a href="distributed-load-test.html"><strong aria-hidden="true">12.</strong> Distributed Load Test</a></li><li class="chapter-item expanded "><a href="rustls.html"><strong aria-hidden="true">13.</strong> RustLS</a></li><li class="chapter-item expanded affix "><li class="part-title">Developers</li><li class="chapter-item expanded "><a href="developers.html"><strong aria-hidden="true">14.</strong> Developers</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><a href="contributors.html">Contributors</a></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">The Swanling Book</h1>

                    <div class="right-buttons">
                                                <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="load-test-debug-logging"><a class="header" href="#load-test-debug-logging">Load Test Debug Logging</a></h1>
<p>Swanling can optionally and efficiently log arbitrary details, and specifics about requests and responses for debug purposes. A central logging thread maintains a buffer to minimize the IO overhead, and controls the writing to ensure that multiple threads don't corrupt each other's messages.</p>
<p>To write to the debug log, you must invoke <code>client.log_debug(tag, Option&lt;request&gt;, Option&lt;headers&gt;, Option&lt;body&gt;)</code> from your load test task functions. The <code>tag</code> field is required and can be any arbitrary string: it can identify where in the load test the log was generated, and/or why debug is being written, and/or other details such as the contents of a form the load test posts. The <code>request</code> field is an optional reference to the <a href="https://docs.rs/swanling/*/swanling/swanling/struct.SwanlingRawRequest"><code>SwanlingRawRequest</code></a> object and provides details such as what URL was requested and if it redirected, how long into the load test the request was made, which SwanlingUser thread made the request, and what status code the server responded with. The <code>headers</code> field is an optional reference to all the HTTP headers returned by the remote server for this request. The <code>body</code> field is an optional reference to the entire web page body returned by the server for this request.</p>
<p>See <code>examples/drupal_loadtest</code> for an example of how you might invoke log_debug from a load test.</p>
<p>Calls to <code>client.set_failure(tag, Option&lt;request&gt;, Option&lt;headers&gt;, Option&lt;body&gt;)</code> can be used to tell Swanling that a request failed even though the server returned a successful status code, and will automatically invoke <code>log_debug()</code> for you. See <code>examples/drupal_loadtest</code> and <code>examples/umami</code> to see how you might use <code>set_failure</code> to generate useful debug logs.</p>
<p>When the load test is run with the <code>--debug-log=foo</code> command line option, where <code>foo</code> is either a relative or an absolute path, Swanling will log all debug generated by calls to <code>client.log_debug()</code> (or to <code>client.set_failure()</code>) to this file. If the file already exists it will be overwritten. The following is an example debug log file entry:</p>
<pre><code class="language-json">{&quot;body&quot;:&quot;&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;503 Backend fetch failed&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;h1&gt;Error 503 Backend fetch failed&lt;/h1&gt;\n    &lt;p&gt;Backend fetch failed&lt;/p&gt;\n    &lt;h3&gt;Guru Meditation:&lt;/h3&gt;\n    &lt;p&gt;XID: 923425&lt;/p&gt;\n    &lt;hr&gt;\n    &lt;p&gt;Varnish cache server&lt;/p&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n&quot;,&quot;header&quot;:&quot;{\&quot;date\&quot;: \&quot;Wed, 01 Jul 2020 10:27:31 GMT\&quot;, \&quot;server\&quot;: \&quot;Varnish\&quot;, \&quot;content-type\&quot;: \&quot;text/html; charset=utf-8\&quot;, \&quot;retry-after\&quot;: \&quot;5\&quot;, \&quot;x-varnish\&quot;: \&quot;923424\&quot;, \&quot;age\&quot;: \&quot;0\&quot;, \&quot;via\&quot;: \&quot;1.1 varnish (Varnish/6.1)\&quot;, \&quot;x-varnish-cache\&quot;: \&quot;MISS\&quot;, \&quot;x-varnish-cookie\&quot;: \&quot;SESSd7e04cba6a8ba148c966860632ef3636=hejsW1mQnnsHlua0AicCjEpUjnCRTkOLubwL33UJXRU\&quot;, \&quot;content-length\&quot;: \&quot;283\&quot;, \&quot;connection\&quot;: \&quot;keep-alive\&quot;}&quot;,&quot;request&quot;:{&quot;elapsed&quot;:4192,&quot;final_url&quot;:&quot;http://local.dev/node/3247&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;name&quot;:&quot;(Auth) comment form&quot;,&quot;redirected&quot;:false,&quot;response_time&quot;:8,&quot;status_code&quot;:503,&quot;success&quot;:false,&quot;update&quot;:false,&quot;url&quot;:&quot;http://local.dev/node/3247&quot;,&quot;user&quot;:4},&quot;tag&quot;:&quot;post_comment: no form_build_id found on node/3247&quot;}
</code></pre>
<p>If <code>--debug-log=foo</code> is not specified at run time, nothing will be logged and there is no measurable overhead in your load test.</p>
<p>By default Swanling writes debug logs in JSON Lines format. The <code>--debug-format</code> option can be used to log in <code>json</code> or <code>raw</code> format. The <code>raw</code> format is Rust's debug output of the <code>SwanlingDebug</code> object.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="logging-load-test-tasks.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="coordinated-omission-mitigation.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="logging-load-test-tasks.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="coordinated-omission-mitigation.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
